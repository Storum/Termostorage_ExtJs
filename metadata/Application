{
    "type": "Ext.app.Application",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "controllers": [
            "MainView_Controller"
        ],
        "models": [
            "model_temperature",
            "tree_model_objects",
            "model_humid"
        ],
        "name": "Termo",
        "requires": [
            "Ext.util.Point",
            "Termo.Utilities"
        ],
        "stores": [
            "store_temperature",
            "tree_store_objects",
            "store_humid"
        ],
        "views": [
            "MyViewport",
            "MyLabel"
        ]
    },
    "designerId": "application",
    "cn": [
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "launch",
                "implHandler": [
                    "Date.prototype.toLocaleFormat = function(format) {",
                    "",
                    "",
                    "    this.setTime (((this.getTime()/1000.0) - (this.getTimezoneOffset()*60)) * 1000);",
                    "",
                    "",
                    "",
                    "    var f = {y : this.getYear() + 1900,m : this.getMonth() + 1,d : this.getDate(),H : this.getHours(),M : this.getMinutes(),S : this.getSeconds()};",
                    "    for(var k in f)",
                    "        format = format.replace('%' + k, f[k] < 10 ? \"0\" + f[k] : f[k]);",
                    "    return format;",
                    "};",
                    "",
                    "",
                    "Date.prototype.toLocaleFormat2 = function(format) {",
                    "",
                    "",
                    "//    this.setTime (((this.getTime()/1000.0) - (this.getTimezoneOffset()*60)) * 1000);",
                    "",
                    "",
                    "",
                    "    var f = {y : this.getYear() + 1900,m : this.getMonth() + 1,d : this.getDate(),H : this.getHours(),M : this.getMinutes(),S : this.getSeconds()};",
                    "    for(var k in f)",
                    "        format = format.replace('%' + k, f[k] < 10 ? \"0\" + f[k] : f[k]);",
                    "    return format;",
                    "};",
                    "",
                    "var getParams = document.URL.split(\"?\");",
                    "var params = Ext.urlDecode(getParams[getParams.length - 1]);",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "if (!params.access_token)",
                    "{",
                    "    new Termo.view.MyViewport({",
                    "    title : \"iframe\",",
                    "    width : 300,",
                    "    height: 300,",
                    "    layout : 'fit',",
                    "    items : [{",
                    "        xtype : \"component\",",
                    "        autoEl : {",
                    "            tag : \"iframe\",",
                    "            src : \"http://hosting.wialon.com/login.html?redirect_uri=\" + GlobalVars.url_setting + \" &duration=86400\"",
                    "            //src : \"http://hosting.wialon.com/login.html?redirect_uri=http://localhost/xxx/&duration=86400\"",
                    "        }",
                    "        }]",
                    "    }).show();",
                    "",
                    "//    Ext.MessageBox.alert('Ошибка авторизации', 'Вы не авторизованы');",
                    "//    var main_window = Ext.getCmp('id_main_view');",
                    "//    main_window.setDisabled(true);",
                    "",
                    "}",
                    "else",
                    "{",
                    "    new Termo.view.MainView().show();",
                    "",
                    "",
                    "",
                    "    Ext.data.JsonP.request(",
                    "\t\t{",
                    "\t\t\turl: GlobalVars.url_setting + 'php/login.php',",
                    "\t\t\tparams:",
                    "\t\t\t{",
                    "                token: params.access_token,",
                    "\t\t\t\tformat: 'json'",
                    "\t\t\t},",
                    "\t\t\tcallbackKey: 'callback',",
                    "\t\t\tasync: false,",
                    "\t\t\tsuccess: function (result)",
                    "\t\t\t{",
                    "                console.log (result);",
                    "",
                    "",
                    "",
                    "\t\t\t\tif (result.error == 8)",
                    "                    Ext.MessageBox.alert('Ошибка Wialon', 'Неверный токен');",
                    "\t\t\t\telse if (result.error == 4)",
                    "                    Ext.MessageBox.alert('Ошибка Wialon', 'Ошибка ввода Wialon');",
                    "\t\t\t\telse if (result.eid.length !== 0)",
                    "                {",
                    "                    GlobalVars.eid = result.eid;",
                    "",
                    "                    Termo.Utilities.set_user_lbl (result.au);",
                    "",
                    "                    Termo.Utilities.get_unit_group_list();",
                    "                    Termo.Utilities.get_unit_list();",
                    "                    Termo.Utilities.get_report_template_data();",
                    "                    Termo.Utilities.start_tasks ();",
                    "                    ",
                    "",
                    "                }",
                    "                else",
                    "                   Ext.MessageBox.alert('Ошибка Wialon', result.error);",
                    "",
                    "\t\t\t}",
                    "\t\t});",
                    "",
                    "",
                    "    GlobalVars.current_period_type = 1;",
                    "}",
                    "",
                    "",
                    "",
                    "",
                    "",
                    ""
                ]
            },
            "designerId": "35fa97aa-6fe2-46b2-a7df-6c8dd71f8ff6"
        }
    ]
}